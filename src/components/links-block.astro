---
const { links, bgMood } = Astro.props;

const btnDecoratorClass =
  "inline-flex rounded-md bg-primary-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-xs hover:bg-primary-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 dark:shadow-none";

let linkPostfix = `<span class="ml-1" aria-hidden="true">→</span>`;

// Primary button class with bgMood consideration
let btnPrimaryClass = btnDecoratorClass;
btnPrimaryClass +=
  bgMood === "dark"
    ? " bg-primary-400 hover:bg-primary-300 text-gray-900"
    : " bg-primary-600 hover:bg-primary-500 text-white";

// Secondary button class with bgMood consideration
let btnSecondaryClass =
  "bg-secondary-200  text-secondary-900  hover:bg-gray-300 focus-visible:outline-indigo-600 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600";

// Link button class with text color adjustments for bgMood
let btnLinkClass =
  "text-sm font-semibold text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300";

const btnClassMap = {
  primary: btnPrimaryClass,
  secondary: btnSecondaryClass,
  link: btnLinkClass,
};
---

<section>
  {
    links && links.length > 0 && (
      <div class="mt-10 flex flex-wrap items-left justify-left gap-4 lg:gap-x-6 w-full overflow-x-auto">
        {links.map((link, index) => {
          if (!link || Object.keys(link).length === 0) return null;

          // Determine the URL based on link type
          let href = "#";
          let isExternal = false;

          if (link.type === "internal" && link.internalLink?.value?.slug) {
            href = `/${link.internalLink.value.slug}`;
          } else if (link.type === "external" && link.externalLink) {
            href = link.externalLink;
            isExternal = true;
          } else if (link.url) {
            href = link.url;
            isExternal = link.url.startsWith("http");
          }

          const linkProps = isExternal
            ? { target: "_blank", rel: "noopener noreferrer" }
            : {};

          return (
            <a
              href={href}
              {...linkProps}
              class={btnClassMap[link.variant || "primary"] || btnPrimaryClass}
            >
              {link?.label || link?.text || "Learn more"}
              {/* {!isPrimary && (
                <span class="ml-1" aria-hidden="true">
                  →
                </span>
              )} */}
            </a>
          );
        })}
      </div>
    )
  }
</section>
