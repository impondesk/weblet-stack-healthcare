---
const { title, subTitle, excerpt } = Astro.props;

const { features } = Astro.props;
---

<section>
  <div class="relative pt-24 mx-auto max-w-7xl py-16">
    <!-- Features Heading Section -->
    <div class="max-w-3xl">
      <p class="text-sm leading-normal font-bold uppercase text-accent-600">
        {subTitle}
      </p>
      <h2
        class="text-xl leading-tight tracking-tight sm:text-2xl md:text-3xl lg:text-4xl mt-4 font-semibold text-base-900 lg:text-balance"
      >
        {title}
      </h2>
      <p class="text-base leading-normal mt-4 text-base-500 font-medium">
        {excerpt}
      </p>
    </div>

    <!-- Features Section -->
    <div
      class="gap-x-2 gap-y-14 mt-12 lg:gap-12 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"
    >
      {
        features?.map((feature) => (
          <div>
            <div>
              <h3 class="text-base leading-normal sm:text-lg md:text-xl text-base-900 font-semibold">
                {feature.title}

                {feature.summary && feature.description && (
                  <span class="mt-2 text-sm text-accent-600 font-semibold">
                    â€” {feature.summary}
                  </span>
                )}
              </h3>

              {feature.summary && !feature.description && (
                <p class="text-base leading-normal mt-2 text-base-500 font-medium">
                  {feature.summary}
                </p>
              )}

              {feature.tags && feature.tags.length > 0 && (
                <div class="flex flex-wrap gap-2 mt-2">
                  {feature.tags.map((tag) => (
                    <span class="inline-flex items-center rounded-full bg-blue-50 px-2.5 py-0.5 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10">
                      {tag.title || tag.excerpt}
                    </span>
                  ))}
                </div>
              )}

              {feature.description && (
                <p class="text-base leading-normal mt-2 text-base-500 font-normal">
                  {feature.description}
                </p>
              )}

              {feature.ref && feature.refURL && (
                <a
                  href={feature.refURL}
                  {...(feature.refURL.startsWith("http")
                    ? { target: "_blank", rel: "noopener noreferrer" }
                    : {})}
                  class="inline-flex items-center gap-1 mt-3 text-sm font-semibold text-blue-600 hover:text-blue-700 transition-colors"
                >
                  {feature.ref}
                  <svg
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 5l7 7-7 7"
                    />
                  </svg>
                </a>
              )}

              {feature.links && feature.links.length > 0 && (
                <div class="mt-3 flex flex-col gap-2">
                  {feature.links.map((link) => {
                    if (!link || Object.keys(link).length === 0) return null;

                    // Determine the URL based on link type
                    let href = "#";
                    let isExternal = false;

                    if (
                      link.type === "internal" &&
                      link.internalLink?.value?.slug
                    ) {
                      href = `/${link.internalLink.value.slug}`;
                    } else if (link.type === "external" && link.externalLink) {
                      href = link.externalLink;
                      isExternal = true;
                    } else if (link.url) {
                      href = link.url;
                      isExternal = link.url.startsWith("http");
                    }

                    // Determine if link should open in new tab
                    const shouldOpenNewTab = link.openInNewTab || isExternal;
                    const linkProps = shouldOpenNewTab
                      ? { target: "_blank", rel: "noopener noreferrer" }
                      : {};

                    // Determine link styling based on variant
                    const isPrimary = link.variant === "primary";
                    const linkClass = isPrimary
                      ? "inline-flex items-center justify-center gap-1 rounded-lg bg-blue-600 text-white hover:bg-blue-700 px-4 py-2 text-sm font-semibold shadow-sm transition-colors"
                      : "inline-flex items-center gap-1 text-sm font-semibold text-blue-600 hover:text-blue-700 transition-colors";

                    return (
                      <a href={href} {...linkProps} class={linkClass}>
                        {link?.label || link?.text || "Learn more"}
                        {!isPrimary && (
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M9 5l7 7-7 7"
                            />
                          </svg>
                        )}
                      </a>
                    );
                  })}
                </div>
              )}
            </div>
          </div>
        ))
      }
    </div>
    <!-- <div class="w-full mt-12 -mb-12">
      <img
        src="/images/dashboardLight.svg"
        alt="#_"
        class="w-full shadow rounded-t-2xl"
      />
    </div> -->
  </div>
</section>
