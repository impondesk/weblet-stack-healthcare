---
const { title, excerpt, faqs = [], bgMood = "light" } = Astro.props;

const bgClass = bgMood === "dark" ? "bg-gray-900 text-white" : "bg-white";
const excerptClass = bgMood === "dark" ? "text-gray-300" : "text-gray-600";
const questionClass = bgMood === "dark" ? "text-white" : "text-gray-900";
const answerClass = bgMood === "dark" ? "text-gray-300" : "text-gray-700";
const borderClass = bgMood === "dark" ? "border-gray-10" : "border-gray-10";
---

<section class={`py-12 ${bgClass}`}>
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    {
      title && (
        <h2 class="text-3xl md:text-4xl font-bold text-center mb-4">{title}</h2>
      )
    }

    {
      excerpt && (
        <p class={`text-center text-lg mb-12 ${excerptClass}`}>{excerpt}</p>
      )
    }

    <div class="space-y-4">
      {
        faqs.map((faq) => {
          const question = faq?.entry?.question || faq?.question;
          const answer = faq?.entry?.answer || faq?.answer;
          const visibility =
            faq?.entry?.visibility || faq?.visibility || "public";

          // Only show public FAQs
          if (visibility !== "public" || !question || !answer) return null;

          return (
            <details class={`group no-border rounded-lg ${borderClass}`}>
              <summary
                class={`flex items-center justify-between cursor-pointer p-0 font-semibold ${questionClass}  transition-colors select-none`}
              >
                <span class="text-lg">{question}</span>
                <svg
                  class="w-5 h-5 text-gray-500 group-open:rotate-180 transition-transform duration-200 flex-shrink-0 ml-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  />
                </svg>
              </summary>
              <div class={`px-6 pb-6 ${answerClass}`}>
                <p class="text-base leading-relaxed">{answer}</p>
              </div>
            </details>
          );
        })
      }
    </div>
  </div>
</section>

<style>
  /* Hide default details marker */
  details summary::-webkit-details-marker {
    display: none;
  }
  details summary::marker {
    display: none;
  }
</style>
